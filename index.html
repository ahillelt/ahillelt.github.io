<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Alon Hillel‑Tuch · Cybersecurity Professor & AI Governance Expert</title>
  <meta name="description" content="Industry Assistant Professor at NYU Tandon School of Engineering. Expert in cybersecurity, hardware security, AI governance, and AI safety. Former RocketHub co-founder and Stacked Capital managing partner. Research Fellow at Columbia's Earth Institute with expertise in conflict resolution. Congressional testimony on technology policy." />
  <meta name="theme-color" content="#1e40af" />

  <!-- SEO: Canonical URL Load -->
  <link rel="canonical" href="https://ahillelt.github.io/">

  <!-- SEO: Robots -->
  <meta name="robots" content="index, follow, max-image-preview:large">

  <!-- SEO: Open Graph Meta Tags -->
  <meta property="og:type" content="profile">
  <meta property="og:title" content="Alon Hillel‑Tuch · Cybersecurity Professor & AI Governance Expert">
  <meta property="og:description" content="Industry Assistant Professor at NYU Tandon. Expert in cybersecurity, hardware security, AI governance, and AI safety.">
  <meta property="og:url" content="https://ahillelt.github.io/">
  <meta property="og:image" content="https://ahillelt.github.io/headshot2.png">
  <meta property="og:image:width" content="800">
  <meta property="og:image:height" content="800">
  <meta property="og:locale" content="en_US">
  <meta property="og:site_name" content="Alon Hillel-Tuch">

  <!-- SEO: Twitter Card Meta Tags -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@ahillelt">
  <meta name="twitter:creator" content="@ahillelt">
  <meta name="twitter:title" content="Alon Hillel‑Tuch · Cybersecurity Professor">
  <meta name="twitter:description" content="Industry Assistant Professor at NYU Tandon. Expert in cybersecurity, hardware security, AI governance, and AI safety.">
  <meta name="twitter:image" content="https://ahillelt.github.io/headshot2.png">

  <!-- Security Headers -->
  <meta http-equiv="X-Content-Type-Options" content="nosniff" />
  <meta http-equiv="X-Frame-Options" content="SAMEORIGIN" />
  <meta http-equiv="X-XSS-Protection" content="1; mode=block" />
  <meta name="referrer" content="strict-origin-when-cross-origin" />
  <meta http-equiv="Permissions-Policy" content="geolocation=(), microphone=(), camera=(), payment=()" />
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' https://cdn.jwplayer.com https://player.vimeo.com https://www.youtube.com; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com; img-src 'self' data: https:; media-src 'self' https:; frame-src https://cdn.jwplayer.com https://player.vimeo.com https://www.youtube.com; connect-src 'self' https:; frame-ancestors 'self'; base-uri 'self'; form-action 'self';" />

  <!-- Performance: Resource Hints -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="dns-prefetch" href="https://fonts.googleapis.com">
  <link rel="dns-prefetch" href="https://fonts.gstatic.com">

  <!-- Performance: Video Provider Resource Hints -->
  <link rel="preconnect" href="https://cdn.jwplayer.com">
  <link rel="preconnect" href="https://player.vimeo.com">
  <link rel="preconnect" href="https://www.youtube.com">
  <link rel="dns-prefetch" href="https://cdn.jwplayer.com">
  <link rel="dns-prefetch" href="https://player.vimeo.com">
  <link rel="dns-prefetch" href="https://www.youtube.com">

  <!-- Preload Critical Assets -->
  <link rel="preload" href="headshot2.png" as="image" type="image/png" fetchpriority="high">

  <!-- PERFORMANCE: Optimized font loading - reduced weights, added font-display -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Playfair+Display:wght@700;800&display=swap" rel="stylesheet" media="print" onload="this.media='all'; this.onload=null;">
  <noscript><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Playfair+Display:wght@700;800&display=swap" rel="stylesheet"></noscript>

  <!-- External CSS -->
  <link rel="stylesheet" href="styles.css">


  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Person",
    "name": "Alon Hillel‑Tuch",
    "url": "https://ahillelt.github.io/",
    "affiliation": [{"@type":"CollegeOrUniversity","name":"NYU Tandon School of Engineering"}],
    "jobTitle": "Industry Assistant Professor, Computer Science and Engineering",
    "sameAs": [
      "https://engineering.nyu.edu/faculty/alon-hillel-tuch",
      "https://github.com/ahillelt",
      "https://x.com/ahillelt",
      "https://www.linkedin.com/in/ahillelt/"
    ],
    "knowsAbout": ["cybersecurity","hardware security","AI governance","AI safety","cryptography","conflict resolution","human‑AI interaction","resilience","socio‑technical systems","crowdfunding","fintech","technology policy"],
    "alumniOf": ["New York University","Columbia University","Hamilton College"]
  }
  </script>
</head>
<body>
  <!-- ACCESSIBILITY: Skip to main content link -->
  <a href="#main-content" class="skip-link">Skip to main content</a>

  <!-- Global shared utilities to avoid code duplication -->
  <script>
    window.__portfolioUtils = {
      sectionMap: {
        '#about': 'about',
        '#press': 'press',
        '#teaching': 'teaching',
        '#labs': 'labs',
        '#research': 'research',
        '#industry': 'industry',
        '#credentials': 'credentials',
        '#contact': 'contact'
      },
      getCookie: function(name) {
        const value = document.cookie.split('; ').find(row => row.startsWith(name + '='));
        return value ? decodeURIComponent(value.split('=')[1]) : null;
      },
      setCookie: function(name, value, days = 365) {
        const MS_PER_DAY = 864e5; // 86400000 milliseconds in a day
        const expires = new Date(Date.now() + days * MS_PER_DAY).toUTCString();
        // SECURITY: Add Secure flag for HTTPS, SameSite=Strict to prevent CSRF
        const isSecure = window.location.protocol === 'https:' ? '; Secure' : '';
        document.cookie = `${name}=${encodeURIComponent(value)}; expires=${expires}; path=/; SameSite=Strict${isSecure}`;
      }
    };
  </script>

  <!-- Inline script to load saved layout IMMEDIATELY (before render) -->
  <script>
    (function() {
      const getCookie = window.__portfolioUtils.getCookie;

      // Get saved order from localStorage or cookie
      let savedOrder = localStorage.getItem('navOrder');
      if (!savedOrder) {
        savedOrder = getCookie('navOrder');
      }

      // Store in global variable for immediate use
      if (savedOrder) {
        try {
          window.__initialNavOrder = JSON.parse(savedOrder);
        } catch (e) {
          console.error('Failed to parse saved nav order:', e);
        }
      }
    })();
  </script>

  <header class="nav">
    <div class="container nav-inner">
      <div class="brand">
        <a href="#" class="logo" aria-label="Go to top of page">AHT</a>
        <div>Alon Hillel‑Tuch</div>
      </div>
      <button class="menu-toggle" onclick="toggleMenu()" aria-label="Toggle menu">☰</button>
      <nav id="mainNav">
        <div class="drop-indicator" id="dropIndicator"></div>
        <a href="#about">About</a>
        <a href="#press">Press & Speaking</a>
        <a href="#teaching">Teaching</a>
        <a href="#labs">Labs & Centers</a>
        <a href="#research">Research</a>
        <a href="#industry">Industry</a>
        <a href="#credentials">Credentials</a>
        <a href="#contact">Contact</a>
      </nav>
    </div>
  </header>

  <!-- Floating Layout Controls -->
  <div class="layout-controls-floating" id="layoutControls">
    <button class="save-btn" onclick="saveLayout(event)" aria-label="Save current layout" title="Save current layout">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path>
        <polyline points="17 21 17 13 7 13 7 21"></polyline>
        <polyline points="7 3 7 8 15 8"></polyline>
      </svg>
      Save Layout
    </button>
    <button class="reset-btn" onclick="resetLayout(event)" aria-label="Reset to default layout" title="Reset to default layout">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <polyline points="1 4 1 10 7 10"></polyline>
        <path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10"></path>
      </svg>
      Reset Layout
    </button>
  </div>

  <main id="main-content">
    <!-- Hero - Content loaded from hero_content.csv -->
    <section class="hero">
      <div class="container">
        <div class="hero-content" id="hero-container">
          <!-- Hero content will be populated by JavaScript -->
        </div>
      </div>
    </section>

    <script>
      // Load hero content from CSV
      (async function() {
        const container = document.querySelector('#hero-container');
        if (!container) return;

        try {
          const response = await fetch('hero_content.csv', { cache: 'no-store' });
          if (!response.ok) throw new Error('Failed to load hero content');

          const csvText = await response.text();
          const lines = csvText.trim().split('\n');
          const data = {};

          for (let i = 1; i < lines.length; i++) {
            const line = lines[i];
            const commaIndex = line.indexOf(',');
            if (commaIndex > -1) {
              const key = line.substring(0, commaIndex).replace(/^"|"$/g, '');
              let value = line.substring(commaIndex + 1);
              if (value.startsWith('"') && value.endsWith('"')) {
                value = value.slice(1, -1).replace(/""/g, '"');
              }
              data[key] = value;
            }
          }

          const chips = data.chips ? data.chips.split('|').map(chip =>
            `<span class="chip">${chip}</span>`
          ).join('') : '';

          container.innerHTML = `
            <div class="hero-text">
              <span class="eyebrow">${data.eyebrow || ''}</span>
              <h1>${data.title || ''}</h1>
              <p class="tagline">${data.tagline || ''}</p>
              <div class="chips">${chips}</div>
              <div class="cta">
                <a href="${data.cta_primary_link || '#contact'}" class="btn primary">${data.cta_primary_text || 'Contact'}</a>
                <a href="${data.cta_secondary_link || '#'}" target="_blank" class="btn secondary" rel="noopener noreferrer">${data.cta_secondary_text || ''}</a>
              </div>
            </div>
            <div class="portrait">
              <img src="${data.image_src || 'headshot2.png'}"
                   alt="${data.image_alt || 'Alon Hillel-Tuch'}"
                   width="800" height="800" fetchpriority="high" decoding="async"
                   style="width: 100%; height: 100%; object-fit: cover;" />
            </div>
          `;
        } catch (error) {
          console.error('Error loading hero content:', error);
        }
      })();
    </script>

    <!-- Stats - Content loaded from stats.csv -->
    <section class="stats">
      <div class="container">
        <div class="stats-grid" id="stats-container">
          <!-- Stats will be populated by JavaScript -->
        </div>
      </div>
    </section>

    <script>
      (async function() {
        const container = document.querySelector('#stats-container');
        if (!container) return;

        try {
          const response = await fetch('stats.csv', { cache: 'no-store' });
          if (!response.ok) throw new Error('Failed to load stats');

          const csvText = await response.text();
          const lines = csvText.trim().split('\n');

          container.innerHTML = '';
          for (let i = 1; i < lines.length; i++) {
            const line = lines[i];
            const values = [];
            let current = '';
            let inQuotes = false;

            for (let j = 0; j < line.length; j++) {
              const char = line[j];
              if (char === '"') {
                inQuotes = !inQuotes;
              } else if (char === ',' && !inQuotes) {
                values.push(current.replace(/^"|"$/g, ''));
                current = '';
              } else {
                current += char;
              }
            }
            values.push(current.replace(/^"|"$/g, ''));

            const card = document.createElement('div');
            card.className = 'stat-card';
            card.innerHTML = `
              <div class="stat-number">${values[0] || ''}</div>
              <div class="stat-label">${values[1] || ''}</div>
            `;
            container.appendChild(card);
          }
        } catch (error) {
          console.error('Error loading stats:', error);
        }
      })();
    </script>

    <!-- About - Content loaded from about_content.csv and section_headers.csv -->
    <section id="about">
      <div class="container">
        <div class="section-header" id="about-header">
          <!-- Header loaded from section_headers.csv -->
        </div>
        <div class="grid cols-2" id="about-content">
          <!-- Content loaded from about_content.csv -->
        </div>
      </div>
    </section>

    <script>
      // Load About section content from CSV
      (async function() {
        // Load section header
        const headerContainer = document.querySelector('#about-header');
        try {
          const headerResponse = await fetch('section_headers.csv', { cache: 'no-store' });
          if (headerResponse.ok) {
            const csvText = await headerResponse.text();
            const lines = csvText.trim().split('\n');
            for (let i = 1; i < lines.length; i++) {
              const values = lines[i].split(',').map(v => v.replace(/^"|"$/g, ''));
              if (values[0] === 'about') {
                headerContainer.innerHTML = `
                  <h2 class="section-title">${values[1]}</h2>
                  <p class="section-subtitle">${values[2]}</p>
                `;
                break;
              }
            }
          }
        } catch (e) { console.error('Error loading about header:', e); }

        // Load about content
        const contentContainer = document.querySelector('#about-content');
        try {
          const response = await fetch('about_content.csv', { cache: 'no-store' });
          if (!response.ok) throw new Error('Failed to load about content');

          const csvText = await response.text();
          const lines = csvText.trim().split('\n');
          const headers = lines[0].split(',');
          const rows = [];

          for (let i = 1; i < lines.length; i++) {
            const values = [];
            let current = '';
            let inQuotes = false;
            for (let j = 0; j < lines[i].length; j++) {
              const char = lines[i][j];
              if (char === '"') inQuotes = !inQuotes;
              else if (char === ',' && !inQuotes) { values.push(current); current = ''; }
              else current += char;
            }
            values.push(current);
            const row = {};
            headers.forEach((h, idx) => row[h.replace(/^"|"$/g, '')] = values[idx] || '');
            rows.push(row);
          }

          // Build Academic Card
          let academicHtml = '';
          rows.forEach(row => {
            if (['academic_mission', 'education_credentials', 'research_teaching', 'teaching_philosophy'].includes(row.section)) {
              academicHtml += `<h3>${row.title}</h3>`;
              if (row.section === 'education_credentials') {
                const items = row.content.split('|');
                academicHtml += '<ul style="margin-top: 12px;">' + items.map(item => `<li>${item}</li>`).join('') + '</ul>';
              } else {
                academicHtml += `<p>${row.content}</p>`;
              }
              if (row.section === 'education_credentials') academicHtml += '<h4 style="margin-top: 20px;">Research & Teaching</h4>';
              if (row.section === 'research_teaching') academicHtml += '<h4>Teaching Philosophy</h4>';
            }
          });

          // Build Industry Card
          let industryHtml = '<h3>Industry & Entrepreneurship</h3>';
          rows.forEach(row => {
            if (['career_highlights', 'policy_regulatory', 'consulting_advisory'].includes(row.section)) {
              industryHtml += `<h4>${row.title}</h4>`;
              if (row.section === 'career_highlights') {
                const items = row.content.split('|');
                industryHtml += '<ul style="margin-top: 12px; margin-bottom: 20px;">' + items.map(item => `<li>${item}</li>`).join('') + '</ul>';
              } else {
                industryHtml += `<p>${row.content}</p>`;
              }
            }
          });

          contentContainer.innerHTML = `
            <div class="card">${academicHtml}</div>
            <div class="card">${industryHtml}</div>
          `;
        } catch (error) {
          console.error('Error loading about content:', error);
        }
      })();
    </script>

    <!-- Press & Testimony -->
    <section id="press" class="accent-bg">
      <div class="container">
        <div class="section-header">
          <h2 class="section-title">Press & Speaking</h2>
          <p class="section-subtitle">Congressional testimony · International keynotes · Expert commentary on technology policy, AI governance, and financial innovation</p>
        </div>

        <!-- Congressional Testimony - loaded from congressional_testimony.csv -->
        <h3 style="font-size: 32px; text-align: center; color: var(--navy); margin-bottom: 32px;">Congressional Testimony</h3>
        <div class="grid cols-2" id="congressional-testimony-container">
          <!-- Content loaded from congressional_testimony.csv -->
        </div>

        <script>
          (async function() {
            const container = document.querySelector('#congressional-testimony-container');
            if (!container) return;

            try {
              const response = await fetch('congressional_testimony.csv', { cache: 'no-store' });
              if (!response.ok) throw new Error('Failed to load congressional testimony data');

              const csvText = await response.text();
              const lines = csvText.trim().split('\n');
              const headers = lines[0].split(',');

              container.innerHTML = '';
              for (let i = 1; i < lines.length; i++) {
                const values = [];
                let current = '';
                let inQuotes = false;
                for (let j = 0; j < lines[i].length; j++) {
                  const char = lines[i][j];
                  const nextChar = lines[i][j + 1];
                  if (char === '"') {
                    if (inQuotes && nextChar === '"') { current += '"'; j++; }
                    else inQuotes = !inQuotes;
                  } else if (char === ',' && !inQuotes) { values.push(current); current = ''; }
                  else current += char;
                }
                values.push(current);

                const item = {};
                headers.forEach((h, idx) => item[h.replace(/^"|"$/g, '')] = (values[idx] || '').replace(/^"|"$/g, ''));

                const card = document.createElement('article');
                card.className = 'card';

                let videoHtml = '';
                if (item.video_type === 'jwplayer') {
                  videoHtml = `<div class="video-wrapper"><div style="position:relative;overflow:hidden;padding-bottom:56.25%"><iframe sandbox="allow-scripts allow-same-origin allow-presentation" loading="lazy" src="${item.video_src}" width="100%" height="100%" frameborder="0" scrolling="auto" title="${item.title}" style="position:absolute;" allowfullscreen></iframe></div></div>`;
                } else if (item.video_type === 'vimeo') {
                  videoHtml = `<div class="video-wrapper"><iframe sandbox="allow-scripts allow-same-origin allow-presentation" loading="lazy" src="${item.video_src}" title="${item.title}" allow="autoplay; fullscreen; picture-in-picture" allowfullscreen></iframe></div>`;
                }

                let linksHtml = '';
                if (item.links) {
                  const linkPairs = item.links.split('::');
                  linksHtml = '<div class="pub-links">';
                  linkPairs.forEach(pair => {
                    const [label, url] = pair.split('|');
                    if (label && url) linksHtml += `<a href="${url.trim()}" class="pub-link" target="_blank" rel="noopener noreferrer">${label.trim()}</a>`;
                  });
                  linksHtml += '</div>';
                }

                card.innerHTML = `
                  <h3>${item.title}</h3>
                  <p style="color: var(--accent); font-weight: 700; margin-bottom: 8px;">${item.date}</p>
                  ${videoHtml}
                  <p>${item.description}</p>
                  ${linksHtml}
                `;
                container.appendChild(card);
              }
            } catch (error) {
              console.error('Error loading congressional testimony:', error);
            }
          })();
        </script>

        <!-- Keynotes & Speaking - loaded from keynotes_speaking.csv -->
        <div style="margin-top: 80px;">
          <h3 style="font-size: 32px; text-align: center; color: var(--navy); margin-bottom: 8px;">Keynotes & Speaking Engagements</h3>
          <p style="text-align: center; color: var(--text-muted); margin-bottom: 40px; font-size: 16px;">50+ keynote presentations on security, innovation, and technology policy · Featured as Top Global Partner of US government (2015, Secretary John Kerry)</p>

          <div class="grid cols-2" id="keynotes-speaking-container">
            <!-- Content loaded from keynotes_speaking.csv -->
          </div>
        </div>

        <script>
          (async function() {
            const container = document.querySelector('#keynotes-speaking-container');
            if (!container) return;

            try {
              const response = await fetch('keynotes_speaking.csv', { cache: 'no-store' });
              if (!response.ok) throw new Error('Failed to load keynotes data');

              const csvText = await response.text();
              const lines = csvText.trim().split('\n');
              const headers = lines[0].split(',');

              container.innerHTML = '';
              for (let i = 1; i < lines.length; i++) {
                const values = [];
                let current = '';
                let inQuotes = false;
                for (let j = 0; j < lines[i].length; j++) {
                  const char = lines[i][j];
                  const nextChar = lines[i][j + 1];
                  if (char === '"') {
                    if (inQuotes && nextChar === '"') { current += '"'; j++; }
                    else inQuotes = !inQuotes;
                  } else if (char === ',' && !inQuotes) { values.push(current); current = ''; }
                  else current += char;
                }
                values.push(current);

                const item = {};
                headers.forEach((h, idx) => item[h.replace(/^"|"$/g, '')] = (values[idx] || '').replace(/^"|"$/g, ''));

                const card = document.createElement('div');
                card.className = item.video_type !== 'none' && item.video_src ? 'card video-card' : 'card';

                let videoHtml = '';
                if (item.video_type === 'vimeo' && item.video_src) {
                  videoHtml = `<div class="video-wrapper"><iframe sandbox="allow-scripts allow-same-origin allow-presentation" loading="lazy" src="${item.video_src}" title="${item.title}" allow="autoplay; fullscreen; picture-in-picture" allowfullscreen></iframe></div>`;
                } else if (item.video_type === 'youtube' && item.video_src) {
                  videoHtml = `<div class="video-wrapper"><iframe sandbox="allow-scripts allow-same-origin allow-presentation" loading="lazy" src="${item.video_src}" title="${item.title}" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe></div>`;
                }

                let linksHtml = '';
                if (item.links) {
                  const linkPairs = item.links.split('::');
                  linksHtml = '<div class="pub-links">';
                  linkPairs.forEach(pair => {
                    const [label, url] = pair.split('|');
                    if (label && url) linksHtml += `<a href="${url.trim()}" class="pub-link" target="_blank" rel="noopener noreferrer">${label.trim()}</a>`;
                  });
                  linksHtml += '</div>';
                }

                card.innerHTML = `
                  <h3>${item.title}</h3>
                  <p style="color: var(--accent); font-weight: 700; margin-bottom: 8px;">${item.venue} · ${item.date}</p>
                  ${videoHtml}
                  <p>${item.description}</p>
                  ${linksHtml}
                `;
                container.appendChild(card);
              }
            } catch (error) {
              console.error('Error loading keynotes:', error);
            }
          })();
        </script>

        <!-- Academic & Legal Panels - loaded from academic_legal_forums.csv -->
        <div style="margin-top: 60px;">
          <h3 style="font-size: 28px; color: var(--navy); margin-bottom: 28px; text-align: center;">Academic & Legal Forums</h3>
          <div class="grid cols-2" id="academic-legal-container">
            <!-- Content loaded from academic_legal_forums.csv -->
          </div>
        </div>

        <script>
          (async function() {
            const container = document.querySelector('#academic-legal-container');
            if (!container) return;

            try {
              const response = await fetch('academic_legal_forums.csv', { cache: 'no-store' });
              if (!response.ok) throw new Error('Failed to load academic legal forums data');

              const csvText = await response.text();
              const lines = csvText.trim().split('\n');
              const headers = lines[0].split(',');

              container.innerHTML = '';
              for (let i = 1; i < lines.length; i++) {
                const values = [];
                let current = '';
                let inQuotes = false;
                for (let j = 0; j < lines[i].length; j++) {
                  const char = lines[i][j];
                  const nextChar = lines[i][j + 1];
                  if (char === '"') {
                    if (inQuotes && nextChar === '"') { current += '"'; j++; }
                    else inQuotes = !inQuotes;
                  } else if (char === ',' && !inQuotes) { values.push(current); current = ''; }
                  else current += char;
                }
                values.push(current);

                const item = {};
                headers.forEach((h, idx) => item[h.replace(/^"|"$/g, '')] = (values[idx] || '').replace(/^"|"$/g, ''));

                const card = document.createElement('article');
                card.className = 'card';

                let linksHtml = '';
                if (item.links) {
                  const linkPairs = item.links.split('::');
                  linksHtml = '<div class="pub-links">';
                  linkPairs.forEach(pair => {
                    const [label, url] = pair.split('|');
                    if (label && url) linksHtml += `<a href="${url.trim()}" class="pub-link" target="_blank" rel="noopener noreferrer">${label.trim()}</a>`;
                  });
                  linksHtml += '</div>';
                }

                card.innerHTML = `
                  <h3>${item.title}</h3>
                  <p style="color: var(--accent); font-weight: 700; margin-bottom: 8px;">${item.venue} · ${item.date}</p>
                  <p>${item.description}</p>
                  ${linksHtml}
                `;
                container.appendChild(card);
              }
            } catch (error) {
              console.error('Error loading academic legal forums:', error);
            }
          })();
        </script>

        <!-- Press Coverage - loaded from press_coverage.csv -->
        <div style="margin-top: 80px;">
          <h3 style="font-size: 32px; text-align: center; color: var(--navy); margin-bottom: 32px;">Press & Media Coverage</h3>

          <!-- Featured TV/Video Coverage -->
          <div class="grid cols-2" id="press-coverage-container">
            <!-- Content loaded from press_coverage.csv -->
          </div>

        <script>
          (async function() {
            const container = document.querySelector('#press-coverage-container');
            if (!container) return;

            try {
              const response = await fetch('press_coverage.csv', { cache: 'no-store' });
              if (!response.ok) throw new Error('Failed to load press coverage data');

              const csvText = await response.text();
              const lines = csvText.trim().split('\n');
              const headers = lines[0].split(',');

              container.innerHTML = '';
              for (let i = 1; i < lines.length; i++) {
                const values = [];
                let current = '';
                let inQuotes = false;
                for (let j = 0; j < lines[i].length; j++) {
                  const char = lines[i][j];
                  const nextChar = lines[i][j + 1];
                  if (char === '"') {
                    if (inQuotes && nextChar === '"') { current += '"'; j++; }
                    else inQuotes = !inQuotes;
                  } else if (char === ',' && !inQuotes) { values.push(current); current = ''; }
                  else current += char;
                }
                values.push(current);

                const item = {};
                headers.forEach((h, idx) => item[h.replace(/^"|"$/g, '')] = (values[idx] || '').replace(/^"|"$/g, ''));

                const card = document.createElement('article');
                card.className = 'card';

                let videoHtml = '';
                if (item.video_type === 'vimeo' && item.video_src) {
                  videoHtml = `<div class="video-wrapper"><iframe sandbox="allow-scripts allow-same-origin allow-presentation" loading="lazy" src="${item.video_src}" title="${item.title}" allow="autoplay; fullscreen; picture-in-picture" allowfullscreen></iframe></div>`;
                }

                let linksHtml = '';
                if (item.links) {
                  const linkPairs = item.links.split('::');
                  linksHtml = '<div class="pub-links">';
                  linkPairs.forEach(pair => {
                    const [label, url] = pair.split('|');
                    if (label && url) linksHtml += `<a href="${url.trim()}" class="pub-link" target="_blank" rel="noopener noreferrer">${label.trim()}</a>`;
                  });
                  linksHtml += '</div>';
                }

                card.innerHTML = `
                  <h3>${item.title}</h3>
                  <p style="color: var(--accent); font-weight: 700; margin-bottom: 8px;">${item.date}</p>
                  ${videoHtml}
                  <p>${item.description}</p>
                  ${linksHtml}
                `;
                container.appendChild(card);
              }
            } catch (error) {
              console.error('Error loading press coverage:', error);
            }
          })();
        </script>

          <!-- Forbes Technology Council - loaded from forbes_council.csv and forbes_articles.csv -->
          <article class="card" style="margin-top: 40px;" id="forbes-council-container">
            <!-- Content loaded from forbes_council.csv and forbes_articles.csv -->
          </article>

        <script>
          (async function() {
            const container = document.querySelector('#forbes-council-container');
            if (!container) return;

            try {
              // Load forbes council info
              const councilResponse = await fetch('forbes_council.csv', { cache: 'no-store' });
              const councilCsv = await councilResponse.text();
              const councilLines = councilCsv.trim().split('\n');
              const councilData = {};
              for (let i = 1; i < councilLines.length; i++) {
                const commaIndex = councilLines[i].indexOf(',');
                if (commaIndex > -1) {
                  const key = councilLines[i].substring(0, commaIndex).replace(/^"|"$/g, '');
                  let value = councilLines[i].substring(commaIndex + 1);
                  if (value.startsWith('"') && value.endsWith('"')) value = value.slice(1, -1);
                  councilData[key] = value;
                }
              }

              // Load forbes articles
              const articlesResponse = await fetch('forbes_articles.csv', { cache: 'no-store' });
              const articlesCsv = await articlesResponse.text();
              const articlesLines = articlesCsv.trim().split('\n');
              const articles = [];
              for (let i = 1; i < articlesLines.length; i++) {
                const values = [];
                let current = '';
                let inQuotes = false;
                for (let j = 0; j < articlesLines[i].length; j++) {
                  const char = articlesLines[i][j];
                  if (char === '"') inQuotes = !inQuotes;
                  else if (char === ',' && !inQuotes) { values.push(current.replace(/^"|"$/g, '')); current = ''; }
                  else current += char;
                }
                values.push(current.replace(/^"|"$/g, ''));
                if (values[0]) articles.push({ title: values[0], date: values[1], url: values[2] });
              }

              let articlesHtml = articles.map(a => `
                <a href="${a.url}" target="_blank" rel="noopener noreferrer" class="forbes-article-link">
                  <span class="article-title">${a.title}</span>
                  <span class="article-date">${a.date}</span>
                </a>
              `).join('');

              container.innerHTML = `
                <div class="forbes-header">
                  <div><span class="forbes-badge">${councilData.badge || 'Forbes Technology Council'}</span></div>
                  <div>
                    <h3 style="margin: 0 0 8px 0; font-size: 24px;">${councilData.title || ''}</h3>
                    <p style="color: var(--text-secondary); font-size: 15px; line-height: 1.6; margin: 0;">${councilData.description || ''}</p>
                  </div>
                  <div class="pub-links">
                    <a href="${councilData.profile_url || '#'}" class="pub-link" target="_blank" rel="noopener noreferrer">${councilData.profile_text || 'View Profile'}</a>
                  </div>
                </div>
                <div class="forbes-articles-grid">${articlesHtml}</div>
              `;
            } catch (error) {
              console.error('Error loading Forbes council:', error);
            }
          })();
        </script>

          <!-- Major Press Coverage -->
          <!-- News articles are loaded dynamically from news_articles.csv -->
          <div id="news-articles-container" class="grid cols-3" style="margin-top: 40px;">
            <!-- Articles will be populated here by JavaScript -->
          </div>

          <script>
            // Load news articles immediately - inline script executes as soon as DOM element is ready
            (async function() {
              const container = document.querySelector('#news-articles-container');
              if (!container) return;

              try {
                const response = await fetch('news_articles.csv', { cache: 'no-store' });
                if (!response.ok) {
                  throw new Error('Failed to load news articles data');
                }

                const csvText = await response.text();

                // Parse CSV inline to avoid dependency on functions defined later
                const lines = csvText.trim().split('\n');
                const headers = lines[0].split(',');
                const articles = [];

                for (let i = 1; i < lines.length; i++) {
                  // Simple CSV parsing for quoted fields
                  const values = [];
                  let current = '';
                  let insideQuotes = false;

                  for (let j = 0; j < lines[i].length; j++) {
                    const char = lines[i][j];
                    const nextChar = lines[i][j + 1];

                    if (char === '"') {
                      if (insideQuotes && nextChar === '"') {
                        current += '"';
                        j++;
                      } else {
                        insideQuotes = !insideQuotes;
                      }
                    } else if (char === ',' && !insideQuotes) {
                      values.push(current);
                      current = '';
                    } else {
                      current += char;
                    }
                  }
                  values.push(current);

                  const article = {};
                  headers.forEach((header, index) => {
                    article[header] = values[index] || '';
                  });
                  articles.push(article);
                }

                // Render articles
                container.innerHTML = '';
                articles.forEach(article => {
                  const card = document.createElement('article');
                  card.className = 'card';

                  // Simple HTML escaping
                  const escapeHtml = (text) => {
                    const div = document.createElement('div');
                    div.textContent = text;
                    return div.innerHTML;
                  };

                  let html = `
                    <h3>${escapeHtml(article.source)}</h3>
                    <p style="color: var(--accent); font-weight: 700; margin-bottom: 8px;">${escapeHtml(article.date)}</p>
                    <p><strong>"${escapeHtml(article.title)}"</strong></p>
                    <p>${escapeHtml(article.body)}</p>
                  `;

                  if (article.link_url && article.link_url.trim()) {
                    html += `
                    <div class="pub-links">
                      <a href="${escapeHtml(article.link_url)}" class="pub-link" target="_blank" rel="noopener noreferrer">
                        ${article.link_icon ? escapeHtml(article.link_icon) + ' ' : ''}${escapeHtml(article.link_caption)}
                      </a>
                    </div>
                    `;
                  }

                  card.innerHTML = html;
                  container.appendChild(card);
                });
              } catch (error) {
                console.error('Error loading news articles:', error);
                // Show error state
                container.innerHTML = `
                  <div style="padding: 40px; text-align: center; background: var(--bg-tertiary); border-radius: 12px; border: 2px dashed var(--border); grid-column: 1 / -1;">
                    <div style="font-size: 48px; margin-bottom: 8px;">⚠️</div>
                    <h3 style="color: var(--text); margin-bottom: 12px;">Unable to Load Articles</h3>
                    <p style="color: var(--text-muted);">${error.message}</p>
                  </div>
                `;
              }
            })();
          </script>

          <!-- Additional Coverage - loaded from additional_coverage.csv -->
          <div style="margin-top: 40px;" id="additional-coverage-container">
            <!-- Content loaded from additional_coverage.csv -->
          </div>

        <script>
          (async function() {
            const container = document.querySelector('#additional-coverage-container');
            if (!container) return;

            try {
              const response = await fetch('additional_coverage.csv', { cache: 'no-store' });
              const csvText = await response.text();
              const lines = csvText.trim().split('\n');
              const data = {};
              for (let i = 1; i < lines.length; i++) {
                const commaIndex = lines[i].indexOf(',');
                if (commaIndex > -1) {
                  const key = lines[i].substring(0, commaIndex).replace(/^"|"$/g, '');
                  let value = lines[i].substring(commaIndex + 1);
                  if (value.startsWith('"') && value.endsWith('"')) value = value.slice(1, -1).replace(/""/g, '"');
                  data[key] = value;
                }
              }

              container.innerHTML = `
                <div class="card">
                  <h3>Additional Coverage</h3>
                  <p style="margin-bottom: 8px;"><strong>Featured in:</strong> ${data.featured_in || ''}</p>
                  <p style="color: var(--text-muted);">${data.description || ''}</p>
                  <p style="margin-top: 16px; color: var(--accent); font-weight: 600;">${data.cta_text || ''}</p>
                  <div class="pub-links">
                    <a href="${data.cta_link || '#contact'}" class="pub-link">${data.cta_label || 'Media Inquiries'}</a>
                  </div>
                </div>
              `;
            } catch (error) {
              console.error('Error loading additional coverage:', error);
            }
          })();
        </script>
        </div>

        <!-- Podcasts & Webinars - loaded from podcasts_webinars.csv -->
        <div style="margin-top: 60px;">
          <h3 style="font-size: 28px; color: var(--navy); margin-bottom: 28px; text-align: center;">Podcasts & Webinars</h3>
          <div class="grid cols-2" id="podcasts-webinars-container">
            <!-- Content loaded from podcasts_webinars.csv -->
          </div>
        </div>

        <script>
          (async function() {
            const container = document.querySelector('#podcasts-webinars-container');
            if (!container) return;

            try {
              const response = await fetch('podcasts_webinars.csv', { cache: 'no-store' });
              const csvText = await response.text();
              const lines = csvText.trim().split('\n');
              const headers = lines[0].split(',');

              container.innerHTML = '';
              for (let i = 1; i < lines.length; i++) {
                const values = [];
                let current = '';
                let inQuotes = false;
                for (let j = 0; j < lines[i].length; j++) {
                  const char = lines[i][j];
                  const nextChar = lines[i][j + 1];
                  if (char === '"') {
                    if (inQuotes && nextChar === '"') { current += '"'; j++; }
                    else inQuotes = !inQuotes;
                  } else if (char === ',' && !inQuotes) { values.push(current); current = ''; }
                  else current += char;
                }
                values.push(current);

                const item = {};
                headers.forEach((h, idx) => item[h.replace(/^"|"$/g, '')] = (values[idx] || '').replace(/^"|"$/g, ''));

                const card = document.createElement('div');
                card.className = 'card';
                card.innerHTML = `
                  <h3>${item.title}</h3>
                  <p style="color: var(--accent); font-weight: 700; margin-bottom: 8px;">${item.venue} · ${item.date}</p>
                  <p>${item.description}</p>
                `;
                container.appendChild(card);
              }
            } catch (error) {
              console.error('Error loading podcasts webinars:', error);
            }
          })();
        </script>

        <!-- Speaking Topics - loaded from speaking_info.csv and speaking_topics.csv -->
        <div style="margin-top: 60px;" id="speaking-topics-section">
          <!-- Content loaded from speaking_info.csv and speaking_topics.csv -->
        </div>

        <script>
          (async function() {
            const container = document.querySelector('#speaking-topics-section');
            if (!container) return;

            try {
              // Load speaking info
              const infoResponse = await fetch('speaking_info.csv', { cache: 'no-store' });
              const infoCsv = await infoResponse.text();
              const infoLines = infoCsv.trim().split('\n');
              const info = {};
              for (let i = 1; i < infoLines.length; i++) {
                const commaIndex = infoLines[i].indexOf(',');
                if (commaIndex > -1) {
                  const key = infoLines[i].substring(0, commaIndex).replace(/^"|"$/g, '');
                  let value = infoLines[i].substring(commaIndex + 1);
                  if (value.startsWith('"') && value.endsWith('"')) value = value.slice(1, -1);
                  info[key] = value;
                }
              }

              // Load speaking topics
              const topicsResponse = await fetch('speaking_topics.csv', { cache: 'no-store' });
              const topicsCsv = await topicsResponse.text();
              const topicsLines = topicsCsv.trim().split('\n');
              const col1Topics = [], col2Topics = [];

              for (let i = 1; i < topicsLines.length; i++) {
                const values = [];
                let current = '';
                let inQuotes = false;
                for (let j = 0; j < topicsLines[i].length; j++) {
                  const char = topicsLines[i][j];
                  if (char === '"') inQuotes = !inQuotes;
                  else if (char === ',' && !inQuotes) { values.push(current.replace(/^"|"$/g, '')); current = ''; }
                  else current += char;
                }
                values.push(current.replace(/^"|"$/g, ''));

                const topic = { topic: values[0], description: values[1], column: values[2] };
                if (topic.column === '1') col1Topics.push(topic);
                else col2Topics.push(topic);
              }

              const col1Html = col1Topics.map(t => `<li><strong>${t.topic}:</strong> ${t.description}</li>`).join('');
              const col2Html = col2Topics.map(t => `<li><strong>${t.topic}:</strong> ${t.description}</li>`).join('');

              container.innerHTML = `
                <div class="card">
                  <h3>Available for Speaking Engagements</h3>
                  <p>${info.intro || ''}</p>
                  <h4 style="color: var(--navy); margin-top: 24px; margin-bottom: 8px;">${info.section_title || 'Speaking Topics'}</h4>
                  <div class="grid cols-2" style="margin-top: 20px;">
                    <div><ul>${col1Html}</ul></div>
                    <div><ul>${col2Html}</ul></div>
                  </div>
                  <div class="pub-links" style="margin-top: 24px;">
                    <a href="${info.cta_link || '#contact'}" class="pub-link">${info.cta_label || 'Request Speaking Engagement'}</a>
                  </div>
                </div>
              `;
            } catch (error) {
              console.error('Error loading speaking topics:', error);
            }
          })();
        </script>
      </div>
    </section>

    <!-- Teaching -->
    <section id="teaching">
      <div class="container">
        <div class="section-header" id="teaching-header">
          <!-- Header loaded from section_headers.csv -->
        </div>

        <!-- CAE Designations - loaded from cae_designations.csv -->
        <div style="margin-bottom: 48px;" id="cae-designations-container">
          <!-- Content loaded from cae_designations.csv -->
        </div>

        <script>
          // Load teaching section header
          (async function() {
            const headerContainer = document.querySelector('#teaching-header');
            try {
              const response = await fetch('section_headers.csv', { cache: 'no-store' });
              if (response.ok) {
                const csvText = await response.text();
                const lines = csvText.trim().split('\n');
                for (let i = 1; i < lines.length; i++) {
                  const values = lines[i].split(',').map(v => v.replace(/^"|"$/g, ''));
                  if (values[0] === 'teaching') {
                    headerContainer.innerHTML = `
                      <h2 class="section-title">${values[1]}</h2>
                      <p class="section-subtitle">${values[2]}</p>
                    `;
                    break;
                  }
                }
              }
            } catch (e) { console.error('Error loading teaching header:', e); }
          })();

          // Load CAE designations
          (async function() {
            const container = document.querySelector('#cae-designations-container');
            if (!container) return;

            try {
              const response = await fetch('cae_designations.csv', { cache: 'no-store' });
              const csvText = await response.text();
              const lines = csvText.trim().split('\n');

              if (lines.length > 1) {
                const values = [];
                let current = '';
                let inQuotes = false;
                for (let j = 0; j < lines[1].length; j++) {
                  const char = lines[1][j];
                  if (char === '"') inQuotes = !inQuotes;
                  else if (char === ',' && !inQuotes) { values.push(current.replace(/^"|"$/g, '')); current = ''; }
                  else current += char;
                }
                values.push(current.replace(/^"|"$/g, ''));

                const description = values[0];
                const designations = values[1] ? values[1].split('|') : [];

                const designationsHtml = designations.map(d =>
                  `<div style="padding: 12px 24px; background: #fee2e2; color: #991b1b; border: 2px solid #fca5a5; border-radius: 10px; font-weight: 700; font-size: 15px;">${d}</div>`
                ).join('');

                container.innerHTML = `
                  <div class="card">
                    <h3>CAE Designations</h3>
                    <p>${description}</p>
                    <div style="display: flex; flex-wrap: wrap; gap: 16px; margin-top: 20px; justify-content: center;">${designationsHtml}</div>
                  </div>
                `;
              }
            } catch (error) {
              console.error('Error loading CAE designations:', error);
            }
          })();
        </script>

        <!-- View Tabs -->
        <div class="view-tabs">
          <button class="view-tab active" onclick="switchView('history', event)" aria-label="View course history" aria-pressed="true">Course History</button>
          <button class="view-tab" onclick="switchView('details', event)" aria-label="View course details" aria-pressed="false">Course Details</button>
        </div>

        <!-- Course History View -->
        <div id="view-history" class="view-content active">
          <div id="history-container" aria-live="polite" aria-atomic="true"></div>
        </div>

        <!-- Course Details View -->
        <div id="view-details" class="view-content">
          <!-- Year Tabs -->
          <div class="year-tabs">
            <button class="year-tab active" onclick="switchYear('2026')" aria-label="Filter courses from 2026" aria-pressed="true">2026</button>
            <button class="year-tab" onclick="switchYear('2025')" aria-label="Filter courses from 2025" aria-pressed="false">2025</button>
            <button class="year-tab" onclick="switchYear('2024')" aria-label="Filter courses from 2024" aria-pressed="false">2024</button>
            <button class="year-tab" onclick="switchYear('2023')" aria-label="Filter courses from 2023" aria-pressed="false">2023</button>
            <button class="year-tab" onclick="switchYear('all')" aria-label="Show all courses" aria-pressed="false">All Years</button>
          </div>
          <div id="details-container" aria-live="polite" aria-atomic="true"></div>
        </div>

        <!-- Course Development & Curriculum Innovation -->
        <div style="margin-top: 48px;">
          <div class="card">
            <h3>Course Development & Curriculum Innovation</h3>
            <div id="course-development-container"></div>
          </div>
        </div>

        <script>
          // Load course development data immediately
          (async function() {
            const container = document.querySelector('#course-development-container');
            if (!container) return;

            try {
              const response = await fetch('course_development.csv', { cache: 'no-store' });
              if (!response.ok) {
                throw new Error('Failed to load course development data');
              }

              const csvText = await response.text();

              // Parse CSV
              const lines = csvText.trim().split('\n');
              const headers = lines[0].split(',').map(h => h.trim().replace(/^"|"$/g, ''));

              const courses = [];
              for (let i = 1; i < lines.length; i++) {
                const line = lines[i];
                if (!line.trim()) continue;

                const values = [];
                let current = '';
                let inQuotes = false;

                for (let j = 0; j < line.length; j++) {
                  const char = line[j];
                  if (char === '"') {
                    inQuotes = !inQuotes;
                  } else if (char === ',' && !inQuotes) {
                    values.push(current.trim().replace(/^"|"$/g, ''));
                    current = '';
                  } else {
                    current += char;
                  }
                }
                values.push(current.trim().replace(/^"|"$/g, ''));

                const course = {};
                headers.forEach((header, index) => {
                  course[header] = values[index] || '';
                });
                courses.push(course);
              }

              // Render courses
              container.innerHTML = '';
              courses.forEach((course, index) => {
                const p = document.createElement('p');
                p.style.marginTop = index === 0 ? '20px' : '16px';

                const escapeHtml = (text) => {
                  const div = document.createElement('div');
                  div.textContent = text;
                  return div.innerHTML;
                };

                p.innerHTML = `<strong>${escapeHtml(course.course_name)} (${escapeHtml(course.course_code)})</strong> — ${escapeHtml(course.description)}`;

                container.appendChild(p);
              });
            } catch (error) {
              console.error('Error loading course development data:', error);
              container.innerHTML = `
                <p style="color: var(--text-muted); margin-top: 20px; font-style: italic;">Unable to load course development data.</p>
              `;
            }
          })();
        </script>
      </div>
    </section>

    <!-- Labs & Centers - loaded from labs_centers.csv -->
    <section id="labs" class="accent-bg">
      <div class="container">
        <div class="section-header" id="labs-header">
          <!-- Header loaded from section_headers.csv -->
        </div>

        <div class="grid cols-2" id="labs-centers-container">
          <!-- Content loaded from labs_centers.csv -->
        </div>
      </div>
    </section>

    <script>
      // Load labs section header
      (async function() {
        const headerContainer = document.querySelector('#labs-header');
        try {
          const response = await fetch('section_headers.csv', { cache: 'no-store' });
          if (response.ok) {
            const csvText = await response.text();
            const lines = csvText.trim().split('\n');
            for (let i = 1; i < lines.length; i++) {
              const values = lines[i].split(',').map(v => v.replace(/^"|"$/g, ''));
              if (values[0] === 'labs') {
                headerContainer.innerHTML = `
                  <h2 class="section-title">${values[1]}</h2>
                  <p class="section-subtitle">${values[2]}</p>
                `;
                break;
              }
            }
          }
        } catch (e) { console.error('Error loading labs header:', e); }
      })();

      // Load labs and centers
      (async function() {
        const container = document.querySelector('#labs-centers-container');
        if (!container) return;

        try {
          const response = await fetch('labs_centers.csv', { cache: 'no-store' });
          const csvText = await response.text();
          const lines = csvText.trim().split('\n');
          const headers = lines[0].split(',');

          container.innerHTML = '';
          for (let i = 1; i < lines.length; i++) {
            const values = [];
            let current = '';
            let inQuotes = false;
            for (let j = 0; j < lines[i].length; j++) {
              const char = lines[i][j];
              const nextChar = lines[i][j + 1];
              if (char === '"') {
                if (inQuotes && nextChar === '"') { current += '"'; j++; }
                else inQuotes = !inQuotes;
              } else if (char === ',' && !inQuotes) { values.push(current); current = ''; }
              else current += char;
            }
            values.push(current);

            const item = {};
            headers.forEach((h, idx) => item[h.replace(/^"|"$/g, '')] = (values[idx] || '').replace(/^"|"$/g, ''));

            const activities = item.activities ? item.activities.split('|').map(a => `<li>${a}</li>`).join('') : '';

            const card = document.createElement('div');
            card.className = 'card';
            card.innerHTML = `
              <h3>${item.name}</h3>
              <p style="color: var(--accent); font-weight: 700; margin-bottom: 8px;">${item.role}</p>
              <p>${item.description}</p>
              <h4>${item.name.includes('Lab') ? 'Lab Activities' : 'Center Focus Areas'}</h4>
              <ul>${activities}</ul>
              <p style="margin-top: 16px;"><a href="${item.link_url}" target="_blank" rel="noopener noreferrer" style="font-weight: 700;">${item.link_text}</a></p>
            `;
            container.appendChild(card);
          }
        } catch (error) {
          console.error('Error loading labs centers:', error);
        }
      })();
    </script>

    <!-- Research -->
    <section id="research">
      <div class="container">
        <div class="section-header">
          <h2 class="section-title">Research & Publications</h2>
          <p class="section-subtitle">Applied security research addressing real-world challenges</p>
        </div>

        <!-- Research Areas -->
        <!-- Research areas loaded dynamically from research_areas.csv -->
        <div id="research-areas-container" class="grid cols-3">
          <!-- Research areas will be populated here by JavaScript -->
        </div>

        <script>
          // Load research areas immediately - inline script executes as soon as DOM element is ready
          (async function() {
            const container = document.querySelector('#research-areas-container');
            if (!container) return;

            try {
              const response = await fetch('research_areas.csv', { cache: 'no-store' });
              if (!response.ok) throw new Error('Failed to load research areas data');

              const csvText = await response.text();
              const lines = csvText.trim().split('\n');
              const headers = lines[0].split(',');
              const areas = [];

              for (let i = 1; i < lines.length; i++) {
                const values = [];
                let current = '';
                let insideQuotes = false;

                for (let j = 0; j < lines[i].length; j++) {
                  const char = lines[i][j];
                  const nextChar = lines[i][j + 1];

                  if (char === '"') {
                    if (insideQuotes && nextChar === '"') {
                      current += '"';
                      j++;
                    } else {
                      insideQuotes = !insideQuotes;
                    }
                  } else if (char === ',' && !insideQuotes) {
                    values.push(current);
                    current = '';
                  } else {
                    current += char;
                  }
                }
                values.push(current);

                const area = {};
                headers.forEach((header, index) => {
                  area[header] = values[index] || '';
                });
                areas.push(area);
              }

              // Render research areas
              container.innerHTML = '';
              areas.forEach(area => {
                const card = document.createElement('div');
                card.className = 'card';

                const escapeHtml = (text) => {
                  const div = document.createElement('div');
                  div.textContent = text;
                  return div.innerHTML;
                };

                card.innerHTML = `
                  <h3>${escapeHtml(area.title)}</h3>
                  <p>${escapeHtml(area.description)}</p>
                `;

                container.appendChild(card);
              });
            } catch (error) {
              console.error('Error loading research areas:', error);
              container.innerHTML = `
                <div style="padding: 40px; text-align: center; background: var(--bg-tertiary); border-radius: 12px; border: 2px dashed var(--border); grid-column: 1 / -1;">
                  <div style="font-size: 48px; margin-bottom: 8px;">⚠️</div>
                  <h3 style="color: var(--text); margin-bottom: 12px;">Unable to Load Research Areas</h3>
                  <p style="color: var(--text-muted);">${error.message}</p>
                </div>
              `;
            }
          })();
        </script>

        <!-- Publications -->
        <div style="margin-top: 60px;">
          <h3 style="font-size: 32px; text-align: center; color: var(--navy); margin-bottom: 32px;">Papers Published</h3>

          <!-- Papers loaded dynamically from papers_published.csv -->
          <div id="papers-container">
            <!-- Papers will be populated here by JavaScript -->
          </div>

          <script>
            // Load papers immediately - inline script executes as soon as DOM element is ready
            (async function() {
              const container = document.querySelector('#papers-container');
              if (!container) return;

              try {
                const response = await fetch('papers_published.csv', { cache: 'no-store' });
                if (!response.ok) throw new Error('Failed to load papers data');

                const csvText = await response.text();
                const lines = csvText.trim().split('\n');
                const headers = lines[0].split(',');
                const papers = [];

                for (let i = 1; i < lines.length; i++) {
                  const values = [];
                  let current = '';
                  let insideQuotes = false;

                  for (let j = 0; j < lines[i].length; j++) {
                    const char = lines[i][j];
                    const nextChar = lines[i][j + 1];

                    if (char === '"') {
                      if (insideQuotes && nextChar === '"') {
                        current += '"';
                        j++;
                      } else {
                        insideQuotes = !insideQuotes;
                      }
                    } else if (char === ',' && !insideQuotes) {
                      values.push(current);
                      current = '';
                    } else {
                      current += char;
                    }
                  }
                  values.push(current);

                  const paper = {};
                  headers.forEach((header, index) => {
                    paper[header] = values[index] || '';
                  });
                  papers.push(paper);
                }

                // Render papers
                container.innerHTML = '';
                papers.forEach(paper => {
                  const pub = document.createElement('div');
                  pub.className = 'publication';

                  const escapeHtml = (text) => {
                    const div = document.createElement('div');
                    div.textContent = text;
                    return div.innerHTML;
                  };

                  let html = `
                    <div class="pub-title">${escapeHtml(paper.title)}</div>
                    <div class="pub-authors">${escapeHtml(paper.authors)}</div>
                    <div class="pub-venue">${escapeHtml(paper.venue)}</div>
                    <p class="pub-abstract">${escapeHtml(paper.abstract)}</p>
                  `;

                  // Add impact if available
                  if (paper.impact && paper.impact.trim()) {
                    html += `<p style="color: var(--accent); font-size: 14px; margin-top: 8px; font-weight: 600;">${escapeHtml(paper.impact)}</p>`;
                  }

                  // Parse links (format: "Label|URL::Label|URL")
                  if (paper.links && paper.links.trim()) {
                    const linkPairs = paper.links.split('::');
                    html += '<div class="pub-links">';
                    linkPairs.forEach(pair => {
                      const [label, url] = pair.split('|');
                      if (label && url) {
                        html += `<a href="${escapeHtml(url.trim())}" class="pub-link" target="_blank" rel="noopener noreferrer">${escapeHtml(label.trim())}</a>`;
                      }
                    });
                    html += '</div>';
                  }

                  pub.innerHTML = html;
                  container.appendChild(pub);
                });
              } catch (error) {
                console.error('Error loading papers:', error);
                container.innerHTML = `
                  <div style="padding: 40px; text-align: center; background: var(--bg-tertiary); border-radius: 12px; border: 2px dashed var(--border);">
                    <div style="font-size: 48px; margin-bottom: 8px;">⚠️</div>
                    <h3 style="color: var(--text); margin-bottom: 12px;">Unable to Load Papers</h3>
                    <p style="color: var(--text-muted);">${error.message}</p>
                  </div>
                `;
              }
            })();
          </script>
        </div>

        <!-- Patents - loaded from patents.csv -->
        <div style="margin-top: 60px;">
          <h3 style="font-size: 32px; text-align: center; color: var(--navy); margin-bottom: 32px;">Patents</h3>
          <p style="text-align: center; color: var(--text-muted); margin-bottom: 32px; font-size: 16px;">Foundational patents in crowdfunding infrastructure cited by major fintech companies including Square, Capital One, 3M, and cryptocurrency platforms</p>

          <div class="grid cols-2" id="patents-container">
            <!-- Content loaded from patents.csv -->
          </div>
        </div>

        <script>
          (async function() {
            const container = document.querySelector('#patents-container');
            if (!container) return;

            try {
              const response = await fetch('patents.csv', { cache: 'no-store' });
              const csvText = await response.text();
              const lines = csvText.trim().split('\n');
              const headers = lines[0].split(',');

              container.innerHTML = '';
              for (let i = 1; i < lines.length; i++) {
                const values = [];
                let current = '';
                let inQuotes = false;
                for (let j = 0; j < lines[i].length; j++) {
                  const char = lines[i][j];
                  const nextChar = lines[i][j + 1];
                  if (char === '"') {
                    if (inQuotes && nextChar === '"') { current += '"'; j++; }
                    else inQuotes = !inQuotes;
                  } else if (char === ',' && !inQuotes) { values.push(current); current = ''; }
                  else current += char;
                }
                values.push(current);

                const item = {};
                headers.forEach((h, idx) => item[h.replace(/^"|"$/g, '')] = (values[idx] || '').replace(/^"|"$/g, ''));

                const pub = document.createElement('div');
                pub.className = 'publication';
                pub.innerHTML = `
                  <div class="pub-title">${item.title}</div>
                  <div class="pub-authors">${item.authors}</div>
                  <div class="pub-venue">${item.venue}</div>
                  <p class="pub-abstract">${item.abstract}</p>
                  <p style="color: var(--accent); font-size: 14px; margin-top: 12px; font-weight: 600;">${item.impact}</p>
                  <p style="color: var(--text-muted); font-size: 13px; margin-top: 8px;"><strong>Cited by:</strong> ${item.cited_by}</p>
                  <div class="pub-links">
                    <a href="${item.link_url}" class="pub-link" target="_blank" rel="noopener noreferrer">${item.link_text}</a>
                  </div>
                `;
                container.appendChild(pub);
              }
            } catch (error) {
              console.error('Error loading patents:', error);
            }
          })();
        </script>
      </div>
    </section>

    <!-- Industry - loaded from industry_companies.csv -->
    <section id="industry" class="accent-bg">
      <div class="container">
        <div class="section-header" id="industry-header">
          <!-- Header loaded from section_headers.csv -->
        </div>

        <div class="grid cols-2" id="industry-companies-container">
          <!-- Content loaded from industry_companies.csv -->
        </div>

        <script>
          // Load industry section header
          (async function() {
            const headerContainer = document.querySelector('#industry-header');
            try {
              const response = await fetch('section_headers.csv', { cache: 'no-store' });
              if (response.ok) {
                const csvText = await response.text();
                const lines = csvText.trim().split('\n');
                for (let i = 1; i < lines.length; i++) {
                  const values = lines[i].split(',').map(v => v.replace(/^"|"$/g, ''));
                  if (values[0] === 'industry') {
                    headerContainer.innerHTML = `
                      <h2 class="section-title">${values[1]}</h2>
                      <p class="section-subtitle">${values[2]}</p>
                    `;
                    break;
                  }
                }
              }
            } catch (e) { console.error('Error loading industry header:', e); }
          })();

          // Load industry companies
          (async function() {
            const container = document.querySelector('#industry-companies-container');
            if (!container) return;

            try {
              const response = await fetch('industry_companies.csv', { cache: 'no-store' });
              const csvText = await response.text();
              const lines = csvText.trim().split('\n');
              const headers = lines[0].split(',');

              container.innerHTML = '';
              for (let i = 1; i < lines.length; i++) {
                const values = [];
                let current = '';
                let inQuotes = false;
                for (let j = 0; j < lines[i].length; j++) {
                  const char = lines[i][j];
                  const nextChar = lines[i][j + 1];
                  if (char === '"') {
                    if (inQuotes && nextChar === '"') { current += '"'; j++; }
                    else inQuotes = !inQuotes;
                  } else if (char === ',' && !inQuotes) { values.push(current); current = ''; }
                  else current += char;
                }
                values.push(current);

                const item = {};
                headers.forEach((h, idx) => item[h.replace(/^"|"$/g, '')] = (values[idx] || '').replace(/^"|"$/g, ''));

                const achievements = item.achievements ? item.achievements.split('|').map(a => `<li>${a}</li>`).join('') : '';
                const achievementsTitle = item.name.includes('RocketHub') ? 'Key Achievements' : 'Investment Focus';

                const card = document.createElement('div');
                card.className = 'card industry-card';
                card.innerHTML = `
                  <h3>${item.name} · ${item.role}</h3>
                  <p style="color: var(--accent); font-weight: 700; margin-bottom: 8px;">${item.dates}</p>
                  <p>${item.description}</p>
                  <h4>${achievementsTitle}</h4>
                  <ul>${achievements}</ul>
                `;
                container.appendChild(card);
              }
            } catch (error) {
              console.error('Error loading industry companies:', error);
            }
          })();
        </script>

        <!-- Partnership Projects - loaded from partnership_projects.csv -->
        <div style="margin-top: 60px;">
          <h3 style="font-size: 32px; text-align: center; color: var(--navy); margin-bottom: 32px;">Partnership Projects</h3>

          <div class="grid cols-2" id="partnership-large-container">
            <!-- Large cards with videos loaded from partnership_projects.csv -->
          </div>

          <div style="margin-top: 40px;">
            <div class="grid cols-3" id="partnership-small-container">
              <!-- Small cards loaded from partnership_projects.csv -->
            </div>
          </div>
        </div>

        <script>
          (async function() {
            const largeContainer = document.querySelector('#partnership-large-container');
            const smallContainer = document.querySelector('#partnership-small-container');
            if (!largeContainer || !smallContainer) return;

            try {
              const response = await fetch('partnership_projects.csv', { cache: 'no-store' });
              const csvText = await response.text();
              const lines = csvText.trim().split('\n');
              const headers = lines[0].split(',');

              largeContainer.innerHTML = '';
              smallContainer.innerHTML = '';

              for (let i = 1; i < lines.length; i++) {
                const values = [];
                let current = '';
                let inQuotes = false;
                for (let j = 0; j < lines[i].length; j++) {
                  const char = lines[i][j];
                  const nextChar = lines[i][j + 1];
                  if (char === '"') {
                    if (inQuotes && nextChar === '"') { current += '"'; j++; }
                    else inQuotes = !inQuotes;
                  } else if (char === ',' && !inQuotes) { values.push(current); current = ''; }
                  else current += char;
                }
                values.push(current);

                const item = {};
                headers.forEach((h, idx) => item[h.replace(/^"|"$/g, '')] = (values[idx] || '').replace(/^"|"$/g, ''));

                const card = document.createElement('article');
                card.className = 'card';

                let videoHtml = '';
                if (item.video_src) {
                  videoHtml = `<div class="video-wrapper"><iframe sandbox="allow-scripts allow-same-origin allow-presentation" loading="lazy" src="${item.video_src}" title="${item.title}" allow="autoplay; fullscreen; picture-in-picture" allowfullscreen></iframe></div>`;
                }

                card.innerHTML = `
                  <h3>${item.title}</h3>
                  <p style="color: var(--accent); font-weight: 700; margin-bottom: 8px;">${item.partner}</p>
                  ${videoHtml}
                  <p>${item.description}</p>
                `;

                if (item.card_size === 'large') {
                  largeContainer.appendChild(card);
                } else {
                  smallContainer.appendChild(card);
                }
              }
            } catch (error) {
              console.error('Error loading partnership projects:', error);
            }
          })();
        </script>

        <!-- Partnerships & Collaborations - loaded from partners_list.csv -->
        <div style="margin-top: 60px;">
          <h3 style="font-size: 32px; text-align: center; color: var(--navy); margin-bottom: 8px;">Partnerships & Collaborations</h3>
          <p style="text-align: center; margin-bottom: 32px; color: var(--text-muted); font-size: 16px;">Collaborated with leading institutions, corporations, and organizations on innovation, entrepreneurship, and technology policy</p>

          <div class="card" id="partners-list-container">
            <!-- Content loaded from partners_list.csv -->
          </div>
        </div>

        <script>
          (async function() {
            const container = document.querySelector('#partners-list-container');
            if (!container) return;

            try {
              const response = await fetch('partners_list.csv', { cache: 'no-store' });
              const csvText = await response.text();
              const lines = csvText.trim().split('\n');

              let partnersHtml = '';
              for (let i = 1; i < lines.length; i++) {
                const name = lines[i].replace(/^"|"$/g, '').trim();
                if (name) {
                  partnersHtml += `<span style="padding: 10px 20px; background: var(--bg-secondary); border-radius: 8px; font-weight: 600; color: var(--navy); font-size: 14px;">${name}</span>`;
                }
              }

              container.innerHTML = `<div style="display: flex; flex-wrap: wrap; gap: 12px; justify-content: center; align-items: center;">${partnersHtml}</div>`;
            } catch (error) {
              console.error('Error loading partners list:', error);
            }
          })();
        </script>

        <div style="margin-top: 60px;">
          <h3 style="font-size: 32px; text-align: center; color: var(--navy); margin-bottom: 32px;">Private Consulting & Advisory</h3>

          <!-- Consulting engagements loaded dynamically from consulting_advisory.csv -->
          <div id="consulting-container" class="grid cols-2">
            <!-- Consulting cards will be populated here by JavaScript -->
          </div>

          <script>
            // Load consulting engagements immediately - inline script executes as soon as DOM element is ready
            (async function() {
              const container = document.querySelector('#consulting-container');
              if (!container) return;

              try {
                const response = await fetch('consulting_advisory.csv', { cache: 'no-store' });
                if (!response.ok) throw new Error('Failed to load consulting data');

                const csvText = await response.text();
                const lines = csvText.trim().split('\n');
                const headers = lines[0].split(',');
                const engagements = [];

                for (let i = 1; i < lines.length; i++) {
                  const values = [];
                  let current = '';
                  let insideQuotes = false;

                  for (let j = 0; j < lines[i].length; j++) {
                    const char = lines[i][j];
                    const nextChar = lines[i][j + 1];

                    if (char === '"') {
                      if (insideQuotes && nextChar === '"') {
                        current += '"';
                        j++;
                      } else {
                        insideQuotes = !insideQuotes;
                      }
                    } else if (char === ',' && !insideQuotes) {
                      values.push(current);
                      current = '';
                    } else {
                      current += char;
                    }
                  }
                  values.push(current);

                  const engagement = {};
                  headers.forEach((header, index) => {
                    engagement[header] = values[index] || '';
                  });
                  engagements.push(engagement);
                }

                // Render consulting engagements
                container.innerHTML = '';
                engagements.forEach(eng => {
                  const card = document.createElement('div');
                  card.className = 'card';

                  const escapeHtml = (text) => {
                    const div = document.createElement('div');
                    div.textContent = text;
                    return div.innerHTML;
                  };

                  card.innerHTML = `
                    <h3>${escapeHtml(eng.company)}</h3>
                    <p style="color: var(--accent); font-weight: 700; margin-bottom: 8px;">${escapeHtml(eng.role)}</p>
                    <p>${escapeHtml(eng.description)}</p>
                  `;

                  container.appendChild(card);
                });
              } catch (error) {
                console.error('Error loading consulting engagements:', error);
                container.innerHTML = `
                  <div style="padding: 40px; text-align: center; background: var(--bg-tertiary); border-radius: 12px; border: 2px dashed var(--border); grid-column: 1 / -1;">
                    <div style="font-size: 48px; margin-bottom: 8px;">⚠️</div>
                    <h3 style="color: var(--text); margin-bottom: 12px;">Unable to Load Consulting Data</h3>
                    <p style="color: var(--text-muted);">${error.message}</p>
                  </div>
                `;
              }
            })();
          </script>
        </div>

        <!-- Additional Career Experience - loaded from career_experience.csv -->
        <div style="margin-top: 60px;">
          <h3 style="font-size: 32px; text-align: center; color: var(--navy); margin-bottom: 32px;">Additional Career Experience</h3>

          <div class="grid cols-3" id="career-experience-container">
            <!-- Content loaded from career_experience.csv -->
          </div>
        </div>

        <script>
          (async function() {
            const container = document.querySelector('#career-experience-container');
            if (!container) return;

            try {
              const response = await fetch('career_experience.csv', { cache: 'no-store' });
              const csvText = await response.text();
              const lines = csvText.trim().split('\n');
              const headers = lines[0].split(',');

              container.innerHTML = '';
              for (let i = 1; i < lines.length; i++) {
                const values = [];
                let current = '';
                let inQuotes = false;
                for (let j = 0; j < lines[i].length; j++) {
                  const char = lines[i][j];
                  const nextChar = lines[i][j + 1];
                  if (char === '"') {
                    if (inQuotes && nextChar === '"') { current += '"'; j++; }
                    else inQuotes = !inQuotes;
                  } else if (char === ',' && !inQuotes) { values.push(current); current = ''; }
                  else current += char;
                }
                values.push(current);

                const item = {};
                headers.forEach((h, idx) => item[h.replace(/^"|"$/g, '')] = (values[idx] || '').replace(/^"|"$/g, ''));

                const card = document.createElement('div');
                card.className = 'card';
                card.innerHTML = `
                  <h3>${item.company}</h3>
                  <p style="color: var(--accent); font-weight: 700; margin-bottom: 8px;">${item.dates} · ${item.role}</p>
                  <p>${item.description}</p>
                `;
                container.appendChild(card);
              }
            } catch (error) {
              console.error('Error loading career experience:', error);
            }
          })();
        </script>
      </div>
    </section>

    <!-- Awards & Credentials - loaded from credentials.csv -->
    <section id="credentials">
      <div class="container">
        <div class="section-header" id="credentials-header">
          <!-- Header loaded from section_headers.csv -->
        </div>

        <div class="grid cols-2" id="credentials-container">
          <!-- Content loaded from credentials.csv -->
        </div>

        <!-- Languages - loaded from languages.csv -->
        <div style="margin-top: 40px;" id="languages-container">
          <!-- Content loaded from languages.csv -->
        </div>

        <!-- Technical Skills - loaded from technical_skills.csv -->
        <div style="margin-top: 40px;" id="technical-skills-container">
          <!-- Content loaded from technical_skills.csv -->
        </div>

        <!-- Education - loaded from education.csv -->
        <div style="margin-top: 40px;" id="education-container">
          <!-- Content loaded from education.csv -->
        </div>

        <script>
          // Load credentials section header
          (async function() {
            const headerContainer = document.querySelector('#credentials-header');
            try {
              const response = await fetch('section_headers.csv', { cache: 'no-store' });
              if (response.ok) {
                const csvText = await response.text();
                const lines = csvText.trim().split('\n');
                for (let i = 1; i < lines.length; i++) {
                  const values = lines[i].split(',').map(v => v.replace(/^"|"$/g, ''));
                  if (values[0] === 'credentials') {
                    headerContainer.innerHTML = `
                      <h2 class="section-title">${values[1]}</h2>
                      <p class="section-subtitle">${values[2]}</p>
                    `;
                    break;
                  }
                }
              }
            } catch (e) { console.error('Error loading credentials header:', e); }
          })();

          // Load credentials
          (async function() {
            const container = document.querySelector('#credentials-container');
            if (!container) return;

            try {
              const response = await fetch('credentials.csv', { cache: 'no-store' });
              const csvText = await response.text();
              const lines = csvText.trim().split('\n');

              container.innerHTML = '';
              for (let i = 1; i < lines.length; i++) {
                const values = [];
                let current = '';
                let inQuotes = false;
                for (let j = 0; j < lines[i].length; j++) {
                  const char = lines[i][j];
                  const nextChar = lines[i][j + 1];
                  if (char === '"') {
                    if (inQuotes && nextChar === '"') { current += '"'; j++; }
                    else inQuotes = !inQuotes;
                  } else if (char === ',' && !inQuotes) { values.push(current); current = ''; }
                  else current += char;
                }
                values.push(current);

                const category = (values[0] || '').replace(/^"|"$/g, '');
                const items = (values[1] || '').replace(/^"|"$/g, '').split('|');

                const card = document.createElement('div');
                card.className = 'card';
                card.innerHTML = `
                  <h3>${category}</h3>
                  <ul style="margin-top: 16px;">${items.map(item => `<li>${item}</li>`).join('')}</ul>
                `;
                container.appendChild(card);
              }
            } catch (error) {
              console.error('Error loading credentials:', error);
            }
          })();

          // Load languages
          (async function() {
            const container = document.querySelector('#languages-container');
            if (!container) return;

            try {
              const response = await fetch('languages.csv', { cache: 'no-store' });
              const csvText = await response.text();
              const lines = csvText.trim().split('\n');

              let languagesHtml = '';
              for (let i = 1; i < lines.length; i++) {
                const values = lines[i].split(',').map(v => v.replace(/^"|"$/g, ''));
                languagesHtml += `<span style="padding: 12px 24px; background: var(--bg-secondary); border-radius: 8px; font-weight: 600; color: var(--navy); font-size: 15px;">${values[0]} <span style="color: var(--text-muted); font-weight: 400;">(${values[1]})</span></span>`;
              }

              container.innerHTML = `
                <div class="card">
                  <h3 style="text-align: center; margin-bottom: 24px;">Languages</h3>
                  <div style="display: flex; flex-wrap: wrap; gap: 16px; justify-content: center; align-items: center;">${languagesHtml}</div>
                </div>
              `;
            } catch (error) {
              console.error('Error loading languages:', error);
            }
          })();

          // Load technical skills
          (async function() {
            const container = document.querySelector('#technical-skills-container');
            if (!container) return;

            try {
              const response = await fetch('technical_skills.csv', { cache: 'no-store' });
              const csvText = await response.text();
              const lines = csvText.trim().split('\n');

              let skillsHtml = '';
              for (let i = 1; i < lines.length; i++) {
                const values = [];
                let current = '';
                let inQuotes = false;
                for (let j = 0; j < lines[i].length; j++) {
                  const char = lines[i][j];
                  if (char === '"') inQuotes = !inQuotes;
                  else if (char === ',' && !inQuotes) { values.push(current.replace(/^"|"$/g, '')); current = ''; }
                  else current += char;
                }
                values.push(current.replace(/^"|"$/g, ''));

                const items = values[2] ? values[2].split('|').map(item => `<p style="color: var(--text-muted); line-height: 1.8;">${item}</p>`).join('') : '';
                skillsHtml += `
                  <div>
                    <h4 style="color: var(--navy); font-size: 16px; margin-bottom: 12px;">${values[1]}</h4>
                    ${items}
                  </div>
                `;
              }

              container.innerHTML = `
                <div class="card">
                  <h3 style="text-align: center; margin-bottom: 24px;">Technical Skills & Expertise</h3>
                  <div class="grid cols-2" style="margin-top: 24px;">${skillsHtml}</div>
                </div>
              `;
            } catch (error) {
              console.error('Error loading technical skills:', error);
            }
          })();

          // Load education
          (async function() {
            const container = document.querySelector('#education-container');
            if (!container) return;

            try {
              const response = await fetch('education.csv', { cache: 'no-store' });
              const csvText = await response.text();
              const lines = csvText.trim().split('\n');

              let educationHtml = '';
              for (let i = 1; i < lines.length; i++) {
                const values = [];
                let current = '';
                let inQuotes = false;
                for (let j = 0; j < lines[i].length; j++) {
                  const char = lines[i][j];
                  if (char === '"') inQuotes = !inQuotes;
                  else if (char === ',' && !inQuotes) { values.push(current.replace(/^"|"$/g, '')); current = ''; }
                  else current += char;
                }
                values.push(current.replace(/^"|"$/g, ''));

                const additional = values[4] ? values[4].split('|').map(a => `<p style="color: var(--text-muted); font-size: 13px; margin-top: 4px;">${a}</p>`).join('') : '';

                educationHtml += `
                  <div style="text-align: center; padding: 20px;">
                    <h4 style="color: var(--navy); font-size: 18px; margin-bottom: 8px;">${values[0]}</h4>
                    <p style="color: var(--accent); font-weight: 600;">${values[1]}</p>
                    <p style="color: var(--text-muted); font-size: 14px; margin-top: 8px;">${values[2]}</p>
                    ${values[3] ? `<p style="color: var(--text-muted); font-size: 13px; margin-top: 8px;">${values[3]}</p>` : ''}
                    ${additional}
                  </div>
                `;
              }

              container.innerHTML = `
                <div class="card">
                  <h3 style="text-align: center; margin-bottom: 20px;">Education</h3>
                  <div class="grid cols-3" style="margin-top: 24px;">${educationHtml}</div>
                </div>
              `;
            } catch (error) {
              console.error('Error loading education:', error);
            }
          })();
        </script>
      </div>
    </section>

    <!-- Contact - loaded from contact_info.csv and professional_profiles.csv -->
    <section id="contact">
      <div class="container">
        <div class="section-header" id="contact-header">
          <!-- Header loaded from section_headers.csv -->
        </div>

        <div class="grid cols-2" id="contact-info-container">
          <!-- Content loaded from contact_info.csv -->
        </div>

        <div class="card" style="margin-top: 32px;" id="professional-profiles-container">
          <!-- Content loaded from professional_profiles.csv -->
        </div>

        <script>
          // Load contact section header
          (async function() {
            const headerContainer = document.querySelector('#contact-header');
            try {
              const response = await fetch('section_headers.csv', { cache: 'no-store' });
              if (response.ok) {
                const csvText = await response.text();
                const lines = csvText.trim().split('\n');
                for (let i = 1; i < lines.length; i++) {
                  const values = lines[i].split(',').map(v => v.replace(/^"|"$/g, ''));
                  if (values[0] === 'contact') {
                    headerContainer.innerHTML = `
                      <h2 class="section-title">${values[1]}</h2>
                      <p class="section-subtitle">${values[2]}</p>
                    `;
                    break;
                  }
                }
              }
            } catch (e) { console.error('Error loading contact header:', e); }
          })();

          // Load contact info
          (async function() {
            const container = document.querySelector('#contact-info-container');
            if (!container) return;

            try {
              const response = await fetch('contact_info.csv', { cache: 'no-store' });
              const csvText = await response.text();
              const lines = csvText.trim().split('\n');
              const headers = lines[0].split(',');

              container.innerHTML = '';
              for (let i = 1; i < lines.length; i++) {
                const values = [];
                let current = '';
                let inQuotes = false;
                for (let j = 0; j < lines[i].length; j++) {
                  const char = lines[i][j];
                  if (char === '"') inQuotes = !inQuotes;
                  else if (char === ',' && !inQuotes) { values.push(current.replace(/^"|"$/g, '')); current = ''; }
                  else current += char;
                }
                values.push(current.replace(/^"|"$/g, ''));

                const item = {};
                headers.forEach((h, idx) => item[h.replace(/^"|"$/g, '')] = values[idx] || '');

                const card = document.createElement('div');
                card.className = 'card';
                card.innerHTML = `
                  <h3>${item.title}</h3>
                  <p>${item.description}</p>
                  <p style="margin-top: 16px;"><strong>${item.email_label}:</strong> ${item.email}</p>
                  ${item.office ? `<p><strong>Office:</strong> ${item.office}</p>` : ''}
                  <p style="margin-top: 16px; color: var(--text-muted); font-size: 14px;">${item.note}</p>
                `;
                container.appendChild(card);
              }
            } catch (error) {
              console.error('Error loading contact info:', error);
            }
          })();

          // Load professional profiles
          (async function() {
            const container = document.querySelector('#professional-profiles-container');
            if (!container) return;

            try {
              const response = await fetch('professional_profiles.csv', { cache: 'no-store' });
              const csvText = await response.text();
              const lines = csvText.trim().split('\n');

              let profilesHtml = '';
              for (let i = 1; i < lines.length; i++) {
                const values = lines[i].split(',').map(v => v.replace(/^"|"$/g, ''));
                profilesHtml += `<a href="${values[1]}" target="_blank" class="btn secondary" rel="noopener noreferrer">${values[0]}</a>`;
              }

              container.innerHTML = `
                <h3 style="text-align: center; margin-bottom: 24px;">Professional Profiles</h3>
                <div class="cta" style="justify-content: center;">${profilesHtml}</div>
              `;
            } catch (error) {
              console.error('Error loading professional profiles:', error);
            }
          })();
        </script>
      </div>
    </section>
  </main>

  <!-- Immediate reordering script (runs as soon as DOM is parsed) -->
  <script>
    (function() {
      // Guard: Prevent double execution
      if (!window.__initialNavOrder || window.__layoutReordered) return;

      const nav = document.getElementById('mainNav');
      const main = document.querySelector('main');

      // Null safety checks
      if (!nav || !main) {
        console.error('Required elements not found');
        return;
      }
      const sectionMap = window.__portfolioUtils.sectionMap;

      // REORDER NAV ITEMS IMMEDIATELY
      const navItems = Array.from(nav.querySelectorAll('a'));
      const itemMap = {};
      navItems.forEach(item => {
        itemMap[item.getAttribute('href')] = item;
      });

      const dropIndicator = document.getElementById('dropIndicator');
      const layoutControls = nav.querySelector('.layout-controls');

      navItems.forEach(item => item.remove());

      const firstNonLink = dropIndicator || layoutControls;
      window.__initialNavOrder.forEach(href => {
        if (itemMap[href]) {
          if (firstNonLink) {
            nav.insertBefore(itemMap[href], firstNonLink);
          } else {
            nav.appendChild(itemMap[href]);
          }
        }
      });

      // REORDER SECTIONS IMMEDIATELY
      const sections = {};
      Object.values(sectionMap).forEach(id => {
        const section = document.getElementById(id);
        if (section) {
          sections[id] = section;
          section.style.transition = 'none';
        }
      });

      window.__initialNavOrder.forEach(href => {
        const sectionId = sectionMap[href];
        if (sections[sectionId]) {
          main.appendChild(sections[sectionId]);
        }
      });

      // Re-enable transitions immediately
      Object.values(sections).forEach(section => {
        section.style.transition = '';
      });

      // Mark that we've already done the reordering
      window.__layoutReordered = true;
    })();
  </script>

  <footer>
    <div class="container">
      <div class="footer-content">
        <div class="footer-section">
          <h4>Quick Links</h4>
          <ul>
            <li><a href="#about">About</a></li>
            <li><a href="#research">Research</a></li>
            <li><a href="#teaching">Teaching</a></li>
            <li><a href="#labs">Labs & Centers</a></li>
            <li><a href="#industry">Industry</a></li>
            <li><a href="#credentials">Credentials</a></li>
          </ul>
        </div>
        <div class="footer-section">
          <h4>Academic</h4>
          <ul>
            <li><a href="https://engineering.nyu.edu/faculty/alon-hillel-tuch" target="_blank" rel="noopener noreferrer">NYU Faculty Page</a></li>
            <li><a href="https://osiris.cyber.nyu.edu/" target="_blank" rel="noopener noreferrer">OSIRIS Lab</a></li>
            <li><a href="https://cyber.nyu.edu/" target="_blank" rel="noopener noreferrer">Center for Cyber Security</a></li>
            <li><a href="https://scholar.google.com/citations?hl=en&user=yxEpRBIAAAAJ" target="_blank" rel="noopener noreferrer">Google Scholar</a></li>
          </ul>
        </div>
        <div class="footer-section">
          <h4>Professional</h4>
          <ul>
            <li><a href="https://github.com/ahillelt" target="_blank" rel="noopener noreferrer">GitHub</a></li>
            <li><a href="https://x.com/ahillelt" target="_blank" rel="noopener noreferrer">X (Twitter)</a></li>
            <li><a href="https://www.linkedin.com/in/ahillelt/" target="_blank" rel="noopener noreferrer">LinkedIn</a></li>
          </ul>
        </div>
        <div class="footer-section">
          <h4>Contact</h4>
          <ul>
            <li>alon [dot] h [at] nyu [dot] edu</li>
            <li><a href="#contact">Speaking Inquiries</a></li>
            <li><a href="#contact">Consulting</a></li>
          </ul>
        </div>
      </div>
      <div class="footer-bottom">
        <p>© <span id="year"></span> Alon Hillel‑Tuch · Industry Assistant Professor, NYU Tandon School of Engineering</p>
        <p style="margin-top: 8px; opacity: .7;">Hamilton College · Columbia University · New York University</p>
      </div>
    </div>
  </footer>

  <!-- External JavaScript -->
  <script src="script.js"></script>
</body>
</html>
